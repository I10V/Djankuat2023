library(readxl)
t = read_xlsx('даные гидромет.xlsx')
View(t)
t = read_xlsx('даные гидромет.xlsx', sheet = 1:4)
for {i in 1:4
for (i in 1:4){
t = read_xlsx('даные гидромет.xlsx', sheet = i)
}
View(t)
t = list()
for (i in 1:4){
t[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
View(t)
View(t)
View(t[[1]])
t = list()
for (i in 1:4){
t[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
View(t)
View(t[[1]])
View(t[[4]])
View(t[[4]])
t = data.frame(`ДАТА`)
t = data.frame(, `ДАТА`)
library(lubridate)
t = seq(ymd('1938-01-01'),ymd('1940-31-12'))
t = seq(ymd('1938-01-01'),ymd('1940-31-12'), by = '1 day')
t = seq(ymd('1938-01-01'),ymd('1940-31-12'), by = 'days')
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days')
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame() %>% t() %>% data.frame()
library(tidyverse)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame() %>% t() %>% data.frame()
View(t)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
View(t)
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = `ДАТА`
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame('ДАТА')
View(t)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
View(t)
t = t %>% right_join(data_ex)
t = t %>% right_join(data_ex[[1]])
View(t)
t = t %>% left_join(data_ex[[1]])
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t = t %>% left_join(data_ex[[1]])
View(t)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lubridate)
library(tidyverse)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]])
t2 = t %>% left_join(data_ex[[2]])
t3 = t %>% left_join(data_ex[[3]])
t4 = t %>% left_join(data_ex[[4]])
View(data_ex)
View(data_ex[[1]])
View(t)
susp = t1 %>% bind_cols(t2)
susp = t1 %>% bind_rows(t2)
View(susp)
View(t)
View(t1)
View(t2)
View(t3)
View(t4)
View(t1)
View(t2)
View(t3)
View(t4)
susp = t2 %>% bind_rows(t4)
bed = t1 %>% bind_rows(t3)
View(bed)
View(t)
View(susp)
View(t)
View(t1)
View(t3)
View(t1)
View(t3)
View(t4)
View(t)
View(data_ex)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4)
bed = t1 %>% bind_rows(t3)
View(data_ex)
View(bed)
names(susp)
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`))
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`))
View(susp)
colnames(susp)
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `дата`, `ГОД`, `tip`))
View(bed)
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `дата`, `ГОД`, `tip`))
View(bed)
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`))
colnames(bed)
colnames(bed) = с('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
View(data_ex)
View(t)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% rigth_join(t)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = с('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = с('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
View(bed)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed)
View(susp_bed)
susp_bed = susp %>% full_join(bed) %>% na.omit()
View(susp_bed)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + 'Расход взвешенных, кг/с',
precentage = `расход влекомых, кг/с` / tota_load )
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + `Расход взвешенных, кг/с`,
precentage = `расход влекомых, кг/с` / tota_load )
View(susp_bed)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + `Расход взвешенных, кг/с`,
precentage = round(`расход влекомых, кг/с` / tota_load *100, 1))
View(susp_bed)
install.packages("psych")
psych::cor.plot(susp_bed)
psych::corPlot(susp_bed)
View(susp_bed)
psych::corPlot(select(susp_bedm -`ДАТА`))
psych::corPlot(select(susp_bed, -`ДАТА`))
View(susp_bed)
View(t3)
View(t4)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lubridate)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lubridate)
library(tidyverse)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + `Расход взвешенных, кг/с`,
precentage = round(`расход влекомых, кг/с` / tota_load *100, 1))
psych::corPlot(select(susp_bed, -`ДАТА`))
View(susp_bed)
psych::corPlot(select(susp_bed, -`ДАТА`), xlas = 0)
psych::corPlot(select(susp_bed, -`ДАТА`), xlas = 1)
psych::corPlot(select(susp_bed, -`ДАТА`), xlas = 2 )
View(susp_bed)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + `Расход взвешенных, кг/с`,
precentage = round(`расход влекомых, кг/с` / tota_load *100, 1)) %>% select(-c(`Расход воды, м3/с bed`, `уровень bed`))
psych::corPlot(select(susp_bed, -`ДАТА`), xlas = 2 )
View(susp_bed)
View(susp_bed)
View(susp_bed)
View(susp_bed)
colnames(susp_bed)
susp_bed = susp_bed %>% mutate(`Расход взвешенных, кг/с` = round(`Расход взвешенных, кг/с`, 1)
,`мутность, мг/л` =  round(`мутность, мг/л`, 0)
,`расход влекомых, кг/с`  = round(`расход влекомых, кг/с`, 1)
,tota_load = round(tota_load, 0)
) %>% select(-`уровень susp`)
colnames(susp_bed)
susp_bed = susp_bed %>% mutate(`Расход взвешенных, кг/с` = round(`Расход взвешенных, кг/с`, 1)
,`мутность, мг/л` =  round(`мутность, мг/л`, 0)
,`расход влекомых, кг/с`  = round(`расход влекомых, кг/с`, 1)
,tota_load = round(tota_load, 0)
) %>% select(-`уровень susp`)
colnames(susp_bed)
colnames(susp_bed)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lubridate)
library(tidyverse)
data_ex = list()
for (i in 1:4){
data_ex[[i]] = read_xlsx('даные гидромет.xlsx', sheet = i)
}
t = seq(ymd('1938-01-01'),ymd('1940-12-31'), by = 'days') %>% data.frame()
colnames(t) = 'ДАТА'
t1 = t %>% left_join(data_ex[[1]]) %>% na.omit()
t2 = t %>% left_join(data_ex[[2]]) %>% na.omit()
t3 = t %>% left_join(data_ex[[3]]) %>% na.omit()
t4 = t %>% left_join(data_ex[[4]]) %>% na.omit()
susp = t2 %>% bind_rows(t4) %>% select(-c(`№`, `дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(susp) = c('ДАТА', 'уровень susp', 'Расход взвешенных, кг/с', 'Расход воды, м3/с susp', 'мутность, мг/л')
bed = t1 %>% bind_rows(t3) %>% select(-c(`№`, `Дата`, `ГОД`, `tip`)) %>% right_join(t)
colnames(bed) = c('ДАТА', 'уровень bed', 'расход влекомых, кг/с', 'Расход воды, м3/с bed')
susp_bed = susp %>% full_join(bed) %>% na.omit() %>% mutate(
tota_load = `расход влекомых, кг/с` + `Расход взвешенных, кг/с`,
precentage = round(`расход влекомых, кг/с` / tota_load *100, 1)) %>% select(-c(`Расход воды, м3/с bed`, `уровень bed`))
psych::corPlot(select(susp_bed, -`ДАТА`), xlas = 2 )
susp_bed = susp_bed %>% mutate(`Расход взвешенных, кг/с` = round(`Расход взвешенных, кг/с`, 1)
,`мутность, мг/л` =  round(`мутность, мг/л`, 0)
,`расход влекомых, кг/с`  = round(`расход влекомых, кг/с`, 1)
,tota_load = round(tota_load, 0)
) %>% select(-`уровень susp`)
colnames(susp_bed) = c('Дата', "Расход взвешенных наносов, кг/с", "Расход воды, м3/с", "Мутность, мг/л", "Расход влекомых наносов, кг/с", 'Суммарный сток наносов, кг/с', 'Доля влекомого стока, %')
psych::corPlot(select(susp_bed, -`Дата`), xlas = 2 )
library(ggplot2)
ggsave("bedload-suspended.png",
bedload_graph,
dpi = 500,
h = 4,
w = 10)
library(imputeTS)
library(clock)
library(see)
theme_set(theme_lucid() +
theme(legend.position = "bottom"))
djan_bed16 <- read_xlsx("sediments_2015_2017.xlsx",
sheet = "vlekomye2016") %>%
dplyr::select(datetime = 2,
bedload = 9) %>%
mutate(datetime = force_tz(datetime, "Europe/Moscow")) %>%
drop_na(datetime) %>%
mutate(datetime = round_date(datetime,
unit = "hour"))
djan_bed17 <- read_xlsx("D:/work/Отчет по Джанкуату 2023/Влекомые наносы, кавказ гидормет/влекомые наносы Толя/sediments_2015_2017.xlsx",
sheet = "vlekomye2017") %>%
dplyr::select(datetime = 4,
bedload = 26) %>%
mutate(datetime = force_tz(datetime, "Europe/Moscow")) %>%
drop_na(datetime) %>%
mutate(datetime = round_date(datetime,
unit = "hour"))
library(imputeTS)
library(clock)
library(see)
theme_set(theme_lucid() +
theme(legend.position = "bottom"))
djan_bed16 <- read_xlsx("D:/work/Отчет по Джанкуату 2023/Влекомые наносы, кавказ гидормет/влекомые наносы Толя/sediments_2015_2017.xlsx",
sheet = "vlekomye2016") %>%
dplyr::select(datetime = 2,
bedload = 9) %>%
mutate(datetime = force_tz(datetime, "Europe/Moscow")) %>%
drop_na(datetime) %>%
mutate(datetime = round_date(datetime,
unit = "hour"))
djan_bed17 <- read_xlsx("D:/work/Отчет по Джанкуату 2023/Влекомые наносы, кавказ гидормет/влекомые наносы Толя/sediments_2015_2017.xlsx",
sheet = "vlekomye2017") %>%
dplyr::select(datetime = 4,
bedload = 26) %>%
mutate(datetime = force_tz(datetime, "Europe/Moscow")) %>%
drop_na(datetime) %>%
mutate(datetime = round_date(datetime,
unit = "hour"))
djan_sed_all <- djan_hydro %>%
mutate(ssd = ssc * q) %>%
mutate(ssd = imputeTS::na_interpolation(ssd)) %>%
right_join(
bind_rows(djan_bed16,
djan_bed17),
by = "datetime"
) %>%
transmute(datetime,
ssd,
bsd = bedload*1000/60)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lubridate)
library(tidyverse)
library(ggplot2)
load("D:/work/Отчет по Джанкуату 2023/Влекомые наносы, кавказ гидормет/.RData")
